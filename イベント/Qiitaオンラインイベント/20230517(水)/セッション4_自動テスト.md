## 「サバンナ便り - 自動テストに関する連載で得られた知見のまとめ（2023年5月版）」

要約
1. 学習用テストの重要性：
- 手を動かしながら学ぶことが重要。
- 学んだ内容を再現できるかが重要。

2. 学びを自動テストで書く方法：
- 学びの名前をメソッドの名前で指定する。
- テストにタグをつける。

3. 偽陽性と偽陰性の理解：
- 偽陽性とは信頼できないテストや脆弱なテストのこと。
- 偽陰性とは空振りやテストのカバレッジ不足、テストコードの漏れ出しなどのこと。
- 誤検知や見逃しが多い場合、テストの信頼性が低下する。

4. テストサイズの分類基準：
- ユニットや単体といった概念は人によって異なるため、テストサイズが良い指標となる。
- テストサイズの分類基準としては、small（1つのプロセスやファイル）、medium（1つのマシン内）、large（複数のプロセスやマシン）があり、アイスクリームのピラミッドのように大きなテストを小さなテストに分割する方法がある。


-------
メモ

■学習用テスト
・手を動かしながら学んでいくことが大事。
・学んだ内容を再現できるかが大事。

学びを自動テストで書く
・学びの名前をメソッドの名前で指定する。
・テストにタグをつける。

疑問をテストにする
・ドキュメント等を追っても分からない時に比較することで一致有無を確認できるなど

驚きをテストにする


■偽陽性と偽陰性
・自動テストの信頼性をむしばむ現象を理解する
・テストの自動化においてITパフォーマンスの予測尺度
└①信頼性の高い自動テストを備えること
　└実行結果を以て、プロダクトの状態を確信できるテスト。
　⇒誤検知（偽陽性）や見逃し（偽陰性）が多い場合、意味ないな。。となる。
　　└誤検知：不安定なend-to-endテスト、フレイキーテスト

偽陽性
⇒信頼不能テスト、脆いテスト（内部処理に依存したテスト）

偽陰性
⇒空振り、カバレッジ不足（テストのカバー率不足）、
テスト対象ロジックのテストコードへの漏れ出し
⇒テストコードとプロダクトコードがともに想定からは誤りがあるが、双方が一致しているため成功となる。

上記が続くと、テストへの信頼喪失が始まる。

■テストサイズ
・自動テストとCIにフィットする明確なテスト分類基準

ユニット、単体とかが人によって概念が違う。
⇒テストスコープではなく、サイズという指標が良いのではないか。
small : 1つのプロセス。1つのファイルを実行するとか。
medium：1つのマシンの中に閉じている。はじめでいえばbackendとか。
large：プロセスにもマシンにも閉じていないテスト。

アイスクリームをどうやってピラミッドにしていくか。
Large⇒Medium：FakeObject
⇒dynamoDblocl⇒dockerコンテナ内で動かせばMediumになる。
ダイナモDBにおけるFakeがダイナモDBローカル

medium⇒small
テストしたいところとしやすいところを分離
テストしにくい要素を切り取る。
⇒テストしたい大部分はコードがかけ、smallになっていく。
